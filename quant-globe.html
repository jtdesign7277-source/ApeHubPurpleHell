<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#050510">
  <title>Quant Globe | ApeHub</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    html, body {
      background: radial-gradient(ellipse at center, #0a0a2e 0%, #050510 50%, #000 100%);
      overflow: hidden;
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
      height: 100%;
      width: 100%;
      position: fixed;
      touch-action: none;
    }

    #canvas-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      transition: opacity 2s ease;
    }

    #canvas-container.loaded {
      opacity: 1;
    }

    /* Back Button */
    .back-btn {
      position: fixed;
      top: env(safe-area-inset-top, 16px);
      left: 16px;
      padding: 8px 14px;
      background: rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      color: rgba(255, 255, 255, 0.7);
      font-size: 13px;
      cursor: pointer;
      z-index: 100;
      transition: all 0.2s;
      text-decoration: none;
      margin-top: 12px;
    }

    .back-btn:hover {
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
    }

    /* Stats Bar */
    .stats-bar {
      position: fixed;
      top: env(safe-area-inset-top, 16px);
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 32px;
      padding: 12px 24px;
      background: rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-radius: 10px;
      z-index: 100;
      margin-top: 12px;
      opacity: 0;
      transition: opacity 1s ease 0.5s;
    }

    .stats-bar.loaded {
      opacity: 1;
    }

    .stat-item {
      text-align: center;
    }

    .stat-label {
      font-size: 0.55rem;
      letter-spacing: 0.1em;
      color: rgba(255, 255, 255, 0.5);
      text-transform: uppercase;
    }

    .stat-value {
      font-size: 1.1rem;
      font-weight: 600;
      font-variant-numeric: tabular-nums;
    }

    .stat-value.cyan { color: #00d4ff; }
    .stat-value.purple { color: #8b00ff; }
    .stat-value.green { color: #00ff88; }

    /* Hot Streak */
    .hot-streak {
      position: fixed;
      top: 80px;
      left: 16px;
      background: linear-gradient(90deg, rgba(255, 100, 0, 0.1) 0%, transparent 100%);
      border-left: 2px solid rgba(255, 102, 0, 0.6);
      padding: 8px 12px;
      border-radius: 0 6px 6px 0;
      z-index: 100;
      opacity: 0;
      transition: opacity 0.5s ease;
    }

    .hot-streak.visible {
      opacity: 1;
    }

    .hot-streak-label {
      font-size: 0.55rem;
      color: #ff6600;
      text-transform: uppercase;
    }

    .hot-streak-user {
      font-size: 0.8rem;
      font-weight: 500;
      color: #fff;
    }

    .hot-streak-stats {
      font-size: 0.7rem;
      color: rgba(255, 255, 255, 0.6);
    }

    .hot-streak-stats .profit {
      color: #00ff88;
    }

    /* Bet Cards */
    .bet-cards-left {
      position: fixed;
      left: 16px;
      top: 160px;
      width: 200px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      z-index: 100;
      opacity: 0;
      transition: opacity 1s ease 0.8s;
    }

    .bet-cards-right {
      position: fixed;
      right: 16px;
      top: 160px;
      width: 200px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      z-index: 100;
      opacity: 0;
      transition: opacity 1s ease 0.8s;
    }

    .bet-cards-left.loaded,
    .bet-cards-right.loaded {
      opacity: 1;
    }

    .bet-card {
      background: rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.05);
      border-radius: 6px;
      padding: 8px 10px;
      animation: slideIn 0.4s ease;
    }

    .bet-card.whale {
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.08) 0%, rgba(0, 0, 0, 0.2) 100%);
      border-color: rgba(255, 215, 0, 0.2);
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .bet-card.from-right {
      animation-name: slideInRight;
    }

    @keyframes slideInRight {
      from { opacity: 0; transform: translateX(20px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .bet-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 3px;
    }

    .bet-user {
      font-size: 0.7rem;
      font-weight: 600;
      color: #fff;
    }

    .bet-position {
      font-size: 0.6rem;
      font-weight: 700;
      padding: 1px 5px;
      border-radius: 3px;
    }

    .bet-position.yes {
      background: rgba(0, 255, 136, 0.15);
      color: #00ff88;
    }

    .bet-position.no {
      background: rgba(255, 68, 102, 0.15);
      color: #ff4466;
    }

    .bet-market {
      font-size: 0.6rem;
      color: rgba(255, 255, 255, 0.85);
      margin-bottom: 3px;
    }

    .bet-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .bet-amount {
      font-size: 0.8rem;
      font-weight: 700;
      color: #00d4ff;
    }

    .bet-amount.whale {
      color: #ffd700;
    }

    .bet-location {
      font-size: 0.5rem;
      color: rgba(255, 255, 255, 0.35);
    }

    /* Trending */
    .trending {
      position: fixed;
      left: 16px;
      bottom: 16px;
      width: 200px;
      z-index: 100;
      opacity: 0;
      transition: opacity 1s ease 1s;
    }

    .trending.loaded {
      opacity: 1;
    }

    .trending-label {
      font-size: 0.55rem;
      letter-spacing: 0.1em;
      color: rgba(0, 212, 255, 0.7);
      margin-bottom: 8px;
    }

    .trending-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 10px;
      background: rgba(0, 0, 0, 0.25);
      border-radius: 5px;
      margin-bottom: 4px;
      border: 1px solid rgba(255, 255, 255, 0.05);
    }

    .trending-name {
      font-size: 0.65rem;
      color: rgba(255, 255, 255, 0.9);
    }

    .trending-odds {
      font-size: 0.65rem;
      font-weight: 600;
      color: #00d4ff;
    }

    /* Place Bet Button */
    .place-bet-btn {
      position: fixed;
      bottom: 16px;
      right: 16px;
      padding: 10px 20px;
      background: rgba(0, 255, 136, 0.1);
      border: 1px solid rgba(0, 255, 136, 0.25);
      border-radius: 6px;
      color: #00ff88;
      font-size: 0.7rem;
      font-weight: 500;
      cursor: pointer;
      z-index: 100;
      opacity: 0;
      transition: all 0.2s, opacity 1s ease 1.2s;
    }

    .place-bet-btn.loaded {
      opacity: 1;
    }

    .place-bet-btn:hover {
      background: rgba(0, 255, 136, 0.2);
      box-shadow: 0 0 20px rgba(0, 255, 136, 0.2);
    }

    /* Whale Alert */
    .whale-alert {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.9);
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-radius: 14px;
      padding: 20px 40px;
      border: 2px solid rgba(255, 215, 0, 0.6);
      z-index: 200;
      text-align: center;
      opacity: 0;
      pointer-events: none;
      transition: all 0.3s ease;
    }

    .whale-alert.visible {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1);
    }

    .whale-emoji {
      font-size: 2.5rem;
    }

    .whale-title {
      font-size: 0.7rem;
      letter-spacing: 0.3em;
      color: #ffd700;
      margin: 6px 0;
      text-transform: uppercase;
    }

    .whale-amount {
      font-size: 1.8rem;
      font-weight: 700;
      color: #fff;
      text-shadow: 0 0 30px rgba(255, 215, 0, 0.8);
    }

    .whale-user {
      font-size: 0.8rem;
      color: rgba(255, 255, 255, 0.8);
      margin-top: 6px;
    }

    .whale-user span {
      color: #ffd700;
    }

    .whale-market {
      font-size: 0.9rem;
      color: #fff;
      margin-top: 4px;
    }

    /* Mobile */
    @media (max-width: 768px) {
      .bet-cards-left,
      .bet-cards-right {
        display: none;
      }

      .trending {
        display: none;
      }

      .hot-streak {
        top: auto;
        bottom: 180px;
        left: 16px;
        right: 16px;
        border-left: none;
        border-top: 2px solid rgba(255, 102, 0, 0.6);
        border-radius: 0 0 6px 6px;
        background: linear-gradient(180deg, rgba(255, 100, 0, 0.1) 0%, transparent 100%);
      }

      .stats-bar {
        gap: 20px;
        padding: 10px 16px;
      }

      .stat-value {
        font-size: 0.9rem;
      }

      .place-bet-btn {
        bottom: calc(100px + env(safe-area-inset-bottom, 0px));
        left: 50%;
        right: auto;
        transform: translateX(-50%);
        padding: 14px 32px;
        font-size: 0.85rem;
        border-radius: 25px;
      }

      .mobile-feed {
        display: block;
      }
    }

    /* Mobile Feed */
    .mobile-feed {
      display: none;
      position: fixed;
      bottom: calc(180px + env(safe-area-inset-bottom, 0px));
      left: 16px;
      right: 16px;
      z-index: 100;
    }

    @media (max-width: 768px) {
      .mobile-feed {
        display: block;
      }
    }

    .mobile-bet-card {
      background: rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-radius: 8px;
      padding: 10px 12px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      margin-bottom: 6px;
      animation: mobileSlideUp 0.4s ease;
    }

    @keyframes mobileSlideUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div id="canvas-container"></div>

  <!-- Back Button -->
  <a href="predictions.html" class="back-btn">‚Üê Back</a>

  <!-- Stats Bar -->
  <div class="stats-bar" id="stats-bar">
    <div class="stat-item">
      <div class="stat-label">24H Volume</div>
      <div class="stat-value cyan" id="volume">$18.4K</div>
    </div>
    <div class="stat-item">
      <div class="stat-label">Bets</div>
      <div class="stat-value purple" id="total-bets">847</div>
    </div>
    <div class="stat-item">
      <div class="stat-label">Live</div>
      <div class="stat-value green" id="active-now">142</div>
    </div>
  </div>

  <!-- Hot Streak -->
  <div class="hot-streak" id="hot-streak">
    <div class="hot-streak-label">üî• Hot Streak</div>
    <div class="hot-streak-user" id="hot-user">diamond_hands</div>
    <div class="hot-streak-stats"><span id="hot-wins">5</span> wins ¬∑ <span class="profit">+$<span id="hot-profit">1,840</span></span></div>
  </div>

  <!-- Bet Cards Left -->
  <div class="bet-cards-left" id="bet-cards-left"></div>

  <!-- Bet Cards Right -->
  <div class="bet-cards-right" id="bet-cards-right"></div>

  <!-- Trending -->
  <div class="trending" id="trending">
    <div class="trending-label">üìà TRENDING</div>
    <div class="trending-item">
      <span class="trending-name">BTC > $150k by June</span>
      <span class="trending-odds">2.4x</span>
    </div>
    <div class="trending-item">
      <span class="trending-name">Ethereum flips BTC</span>
      <span class="trending-odds">12.0x</span>
    </div>
    <div class="trending-item">
      <span class="trending-name">SpaceX Mars 2026</span>
      <span class="trending-odds">8.5x</span>
    </div>
  </div>

  <!-- Place Bet Button -->
  <button class="place-bet-btn" id="place-bet-btn" onclick="window.location.href='predictions.html'">
    ‚ö° Place a bet
  </button>

  <!-- Mobile Feed -->
  <div class="mobile-feed" id="mobile-feed"></div>

  <!-- Whale Alert -->
  <div class="whale-alert" id="whale-alert">
    <div class="whale-emoji">üêã</div>
    <div class="whale-title">Whale Alert</div>
    <div class="whale-amount" id="whale-amount">$5,000</div>
    <div class="whale-user"><span id="whale-user">whale_hunter</span> bet <span id="whale-position">YES</span></div>
    <div class="whale-market" id="whale-market">BTC > $150k by June</div>
  </div>

  <script>
    // Data
    const MARKETS = [
      { name: 'BTC > $150k by June', odds: 2.4 },
      { name: 'Fed cuts rates March', odds: 1.8 },
      { name: 'Chiefs win Super Bowl', odds: 3.2 },
      { name: 'GPT-5 releases Q1', odds: 4.1 },
      { name: 'Ethereum flips BTC', odds: 12.0 },
      { name: 'SpaceX Mars landing 2026', odds: 8.5 },
    ];

    const USERNAMES = [
      'whale_hunter', 'degen_prime', 'moon_shot', 'alpha_seeker',
      'risk_taker', 'diamond_hands', 'quick_flip', 'steady_gains',
      'bet_master', 'odds_shark', 'market_king', 'profit_prophet'
    ];

    const LOCATIONS = [
      { name: 'New York', lat: 40.7, lon: -74.0, flag: 'üá∫üá∏' },
      { name: 'London', lat: 51.5, lon: -0.1, flag: 'üá¨üáß' },
      { name: 'Tokyo', lat: 35.7, lon: 139.7, flag: 'üáØüáµ' },
      { name: 'Singapore', lat: 1.3, lon: 103.8, flag: 'üá∏üá¨' },
      { name: 'Dubai', lat: 25.2, lon: 55.3, flag: 'üá¶üá™' },
      { name: 'Sydney', lat: -33.9, lon: 151.2, flag: 'üá¶üá∫' },
      { name: 'Miami', lat: 25.8, lon: -80.2, flag: 'üá∫üá∏' },
      { name: 'Seoul', lat: 37.6, lon: 127.0, flag: 'üá∞üá∑' },
    ];

    // Three.js Setup
    const container = document.getElementById('canvas-container');
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    container.appendChild(renderer.domElement);

    // Globe with metallic material
    const globeGeometry = new THREE.SphereGeometry(2, 64, 64);
    const globeMaterial = new THREE.MeshPhysicalMaterial({
      color: 0x8b00ff,
      metalness: 0.9,
      roughness: 0.1,
      emissive: 0x00d4ff,
      emissiveIntensity: 0.15,
      clearcoat: 1.0,
      transparent: true,
      opacity: 0.95,
    });
    const globe = new THREE.Mesh(globeGeometry, globeMaterial);
    scene.add(globe);

    // Inner glow
    const innerGlow = new THREE.Mesh(
      new THREE.SphereGeometry(1.95, 64, 64),
      new THREE.MeshBasicMaterial({ color: 0x00d4ff, transparent: true, opacity: 0.3, side: THREE.BackSide })
    );
    globe.add(innerGlow);

    // Wireframe overlay
    const wireframe = new THREE.Mesh(
      new THREE.SphereGeometry(2.02, 32, 32),
      new THREE.MeshBasicMaterial({ color: 0x00ff88, wireframe: true, transparent: true, opacity: 0.3 })
    );
    globe.add(wireframe);

    // Data points on globe
    for (let i = 0; i < 200; i++) {
      const phi = Math.acos(-1 + (2 * i) / 200);
      const theta = Math.sqrt(200 * Math.PI) * phi;
      const point = new THREE.Mesh(
        new THREE.SphereGeometry(0.02 + Math.random() * 0.03, 8, 8),
        new THREE.MeshBasicMaterial({ 
          color: Math.random() > 0.5 ? 0x00d4ff : 0x00ff88, 
          transparent: true, 
          opacity: 0.8 
        })
      );
      point.position.setFromSphericalCoords(2.05, phi, theta);
      globe.add(point);
    }

    // Orbital rings with waves
    const ringGeometry = new THREE.BufferGeometry();
    const ringPositions = new Float32Array(6000 * 3);
    for (let i = 0; i < 6000; i++) {
      const angle = Math.random() * Math.PI * 2;
      const radius = 3.2 + Math.random() * 2.5;
      const wave = Math.sin(angle * 3) * 0.2 + Math.sin(angle * 7) * 0.1;
      ringPositions[i * 3] = Math.cos(angle) * radius;
      ringPositions[i * 3 + 1] = wave + (Math.random() - 0.5) * 0.4;
      ringPositions[i * 3 + 2] = Math.sin(angle) * radius;
    }
    ringGeometry.setAttribute('position', new THREE.BufferAttribute(ringPositions, 3));
    const rings = new THREE.Points(ringGeometry, new THREE.PointsMaterial({
      color: 0x00d4ff,
      size: 0.02,
      transparent: true,
      opacity: 0.3,
      blending: THREE.AdditiveBlending
    }));
    rings.rotation.x = 0.3;
    rings.rotation.z = 0.15;
    scene.add(rings);

    // Stars
    const starsGeometry = new THREE.BufferGeometry();
    const starsPositions = new Float32Array(3000 * 3);
    for (let i = 0; i < 3000; i++) {
      const r = 20 + Math.random() * 80;
      const t = Math.random() * Math.PI * 2;
      const p = Math.random() * Math.PI;
      starsPositions[i * 3] = r * Math.sin(p) * Math.cos(t);
      starsPositions[i * 3 + 1] = r * Math.cos(p);
      starsPositions[i * 3 + 2] = r * Math.sin(p) * Math.sin(t);
    }
    starsGeometry.setAttribute('position', new THREE.BufferAttribute(starsPositions, 3));
    const stars = new THREE.Points(starsGeometry, new THREE.PointsMaterial({
      color: 0xffffff,
      size: 0.5,
      transparent: true,
      opacity: 0.8
    }));
    scene.add(stars);

    // Lights
    scene.add(new THREE.AmbientLight(0x222244, 0.5));
    const mainLight = new THREE.PointLight(0x00d4ff, 2, 50);
    mainLight.position.set(5, 5, 5);
    scene.add(mainLight);
    const accentLight = new THREE.PointLight(0x00ff88, 1, 30);
    accentLight.position.set(0, -5, -5);
    scene.add(accentLight);

    camera.position.z = 8;

    // Active pulses
    const activePulses = [];

    function addPulseToGlobe(location, isYes, isWhale) {
      const phi = (90 - location.lat) * (Math.PI / 180);
      const theta = (location.lon + 180) * (Math.PI / 180);
      
      const x = 2.08 * Math.sin(phi) * Math.cos(theta);
      const y = 2.08 * Math.cos(phi);
      const z = 2.08 * Math.sin(phi) * Math.sin(theta);
      
      const color = isYes ? 0x00ff88 : 0xff4466;
      
      const pulse = new THREE.Mesh(
        new THREE.RingGeometry(0, isWhale ? 0.3 : 0.15, 32),
        new THREE.MeshBasicMaterial({ color, transparent: true, opacity: 1, side: THREE.DoubleSide })
      );
      
      pulse.position.set(x, y, z);
      pulse.lookAt(0, 0, 0);
      pulse.userData = { startTime: Date.now(), duration: isWhale ? 3000 : 2000, maxScale: isWhale ? 5 : 3 };
      
      globe.add(pulse);
      activePulses.push(pulse);
    }

    // Animation
    function animate() {
      requestAnimationFrame(animate);
      
      // Rotate globe
      globe.rotation.y += 0.002;
      globe.rotation.x = Math.sin(Date.now() * 0.0005) * 0.05;
      
      // Rotate rings
      rings.rotation.z += 0.001;
      rings.rotation.y -= 0.0015;

      // Animate pulses
      const now = Date.now();
      for (let i = activePulses.length - 1; i >= 0; i--) {
        const pulse = activePulses[i];
        const progress = (now - pulse.userData.startTime) / pulse.userData.duration;
        
        if (progress >= 1) {
          globe.remove(pulse);
          activePulses.splice(i, 1);
        } else {
          pulse.scale.setScalar(1 + progress * (pulse.userData.maxScale - 1));
          pulse.material.opacity = 1 - progress;
        }
      }

      renderer.render(scene, camera);
    }
    animate();

    // Handle resize
    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });

    // Show loaded state
    setTimeout(() => {
      container.classList.add('loaded');
      document.getElementById('stats-bar').classList.add('loaded');
      document.getElementById('bet-cards-left').classList.add('loaded');
      document.getElementById('bet-cards-right').classList.add('loaded');
      document.getElementById('trending').classList.add('loaded');
      document.getElementById('place-bet-btn').classList.add('loaded');
    }, 100);

    // === Live Data Simulation ===
    let volume = 18420;
    let totalBets = 847;
    let activeNow = 142;
    let leftCards = [];
    let rightCards = [];
    let mobileCards = [];
    let nextSide = 'left';
    const isMobile = window.innerWidth <= 768;

    function formatNumber(n) {
      if (n >= 1000000) return '$' + (n / 1000000).toFixed(2) + 'M';
      if (n >= 1000) return '$' + (n / 1000).toFixed(1) + 'K';
      return '$' + n;
    }

    function generateBet() {
      const market = MARKETS[Math.floor(Math.random() * MARKETS.length)];
      const user = USERNAMES[Math.floor(Math.random() * USERNAMES.length)];
      const location = LOCATIONS[Math.floor(Math.random() * LOCATIONS.length)];
      
      const rand = Math.random();
      let amount;
      if (rand > 0.99) amount = Math.floor(Math.random() * 5000 + 2500);
      else if (rand > 0.92) amount = Math.floor(Math.random() * 1500 + 500);
      else amount = Math.floor(Math.random() * 400 + 25);
      
      const isYes = Math.random() > 0.45;
      const isWhale = amount >= 2500;
      
      return { user, market: market.name, amount, position: isYes ? 'YES' : 'NO', location, isWhale };
    }

    function createBetCard(side, bet, opacity = 1) {
      const card = document.createElement('div');
      card.className = `bet-card ${bet.isWhale ? 'whale' : ''} ${side === 'right' ? 'from-right' : ''}`;
      card.style.opacity = opacity;
      card.innerHTML = `
        <div class="bet-header">
          <span class="bet-user">${bet.isWhale ? 'üêã ' : ''}${bet.user}</span>
          <span class="bet-position ${bet.position.toLowerCase()}">${bet.position}</span>
        </div>
        <div class="bet-market">${bet.market}</div>
        <div class="bet-footer">
          <span class="bet-amount ${bet.isWhale ? 'whale' : ''}">$${bet.amount.toLocaleString()}</span>
          <span class="bet-location">${bet.location.flag} ${bet.location.name}</span>
        </div>
      `;
      return card;
    }

    function createMobileBetCard(bet) {
      const card = document.createElement('div');
      card.className = 'mobile-bet-card';
      card.innerHTML = `
        <div style="display: flex; justify-content: space-between; align-items: center;">
          <div style="display: flex; align-items: center; gap: 10px;">
            <span class="bet-position ${bet.position.toLowerCase()}">${bet.position}</span>
            <div>
              <div class="bet-user">${bet.isWhale ? 'üêã ' : ''}${bet.user}</div>
              <div class="bet-market">${bet.market}</div>
            </div>
          </div>
          <span class="bet-amount ${bet.isWhale ? 'whale' : ''}">$${bet.amount.toLocaleString()}</span>
        </div>
      `;
      return card;
    }

    function addBet() {
      const bet = generateBet();
      
      // Add pulse to globe
      addPulseToGlobe(bet.location, bet.position === 'YES', bet.isWhale);
      
      // Show whale alert
      if (bet.isWhale) {
        document.getElementById('whale-amount').textContent = '$' + bet.amount.toLocaleString();
        document.getElementById('whale-user').textContent = bet.user;
        document.getElementById('whale-position').textContent = bet.position;
        document.getElementById('whale-market').textContent = bet.market;
        document.getElementById('whale-alert').classList.add('visible');
        setTimeout(() => document.getElementById('whale-alert').classList.remove('visible'), 4000);
      }
      
      // Desktop cards
      const container = document.getElementById(`bet-cards-${nextSide}`);
      const cards = nextSide === 'left' ? leftCards : rightCards;
      
      const card = createBetCard(nextSide, bet);
      container.insertBefore(card, container.firstChild);
      cards.unshift(card);
      
      // Update opacity for stacking effect
      cards.forEach((c, i) => c.style.opacity = 1 - i * 0.15);
      
      // Keep only 3 cards
      if (cards.length > 3) {
        const old = cards.pop();
        old.remove();
      }
      
      // Mobile cards
      if (isMobile) {
        const mobileFeed = document.getElementById('mobile-feed');
        const mobileCard = createMobileBetCard(bet);
        mobileFeed.insertBefore(mobileCard, mobileFeed.firstChild);
        mobileCards.unshift(mobileCard);
        
        if (mobileCards.length > 2) {
          const old = mobileCards.pop();
          old.style.opacity = '0';
          setTimeout(() => old.remove(), 300);
        }
      }
      
      // Update stats
      volume += bet.amount;
      totalBets++;
      activeNow += Math.random() > 0.5 ? 2 : -1;
      activeNow = Math.max(80, Math.min(250, activeNow));
      
      document.getElementById('volume').textContent = formatNumber(volume);
      document.getElementById('total-bets').textContent = totalBets.toLocaleString();
      document.getElementById('active-now').textContent = activeNow;
      
      nextSide = nextSide === 'left' ? 'right' : 'left';
    }

    // Hot streak
    function showHotStreak() {
      const user = USERNAMES[Math.floor(Math.random() * USERNAMES.length)];
      const wins = Math.floor(Math.random() * 5 + 3);
      const profit = Math.floor(Math.random() * 3000 + 500);
      
      document.getElementById('hot-user').textContent = user;
      document.getElementById('hot-wins').textContent = wins;
      document.getElementById('hot-profit').textContent = profit.toLocaleString();
      
      document.getElementById('hot-streak').classList.add('visible');
      setTimeout(() => document.getElementById('hot-streak').classList.remove('visible'), 8000);
    }

    // Start simulation
    setTimeout(() => {
      addBet();
      setInterval(addBet, 6000);
    }, 2000);

    setTimeout(showHotStreak, 2000);
    setInterval(showHotStreak, 60000);
  </script>
</body>
</html>
