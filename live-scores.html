<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>Live Scores | ApeHub</title>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-deep: #050a0f;
      --bg-card: #0d1a28;
      --green: #00ff88;
      --red: #ff4757;
      --gold: #ffd700;
      --white: #ffffff;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    html, body {
      font-family: 'Space Grotesk', -apple-system, sans-serif;
      background: linear-gradient(180deg, #050a0f 0%, #0a1520 50%, #0d1a28 100%);
      color: var(--white);
      min-height: 100vh;
    }

    /* Header */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: rgba(5, 10, 15, 0.95);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(255,255,255,0.05);
      padding: 16px 20px;
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .header-title {
      font-size: 20px;
      font-weight: 700;
    }
    .live-indicator {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      color: var(--green);
    }
    .live-dot {
      width: 8px;
      height: 8px;
      background: var(--green);
      border-radius: 50%;
      animation: pulse 1.5s infinite;
    }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }

    /* Main Content */
    .main {
      padding: 80px 16px 100px;
      max-width: 600px;
      margin: 0 auto;
    }

    /* League Tabs */
    .league-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
      overflow-x: auto;
      padding-bottom: 4px;
    }
    .league-tab {
      padding: 10px 20px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 20px;
      font-size: 14px;
      font-weight: 600;
      color: rgba(255,255,255,0.5);
      cursor: pointer;
      white-space: nowrap;
      transition: all 0.2s;
    }
    .league-tab.active {
      background: rgba(0, 255, 136, 0.1);
      border-color: rgba(0, 255, 136, 0.3);
      color: var(--green);
    }

    /* Game Cards */
    .games-container {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    .game-card {
      background: linear-gradient(180deg, #0d1a28, #050a0f);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 16px;
      overflow: hidden;
    }
    .game-card.live {
      border-color: rgba(0, 255, 136, 0.3);
    }
    .game-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 16px;
      background: rgba(255,255,255,0.03);
      border-bottom: 1px solid rgba(255,255,255,0.05);
    }
    .game-status {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      font-weight: 600;
    }
    .game-status.live { color: var(--green); }
    .game-status.final { color: rgba(255,255,255,0.5); }
    .game-time {
      font-size: 12px;
      color: rgba(255,255,255,0.5);
    }

    /* Team Row */
    .team-row {
      display: flex;
      align-items: center;
      padding: 14px 16px;
      gap: 12px;
    }
    .team-row:first-of-type {
      border-bottom: 1px solid rgba(255,255,255,0.05);
    }
    .team-logo {
      width: 36px;
      height: 36px;
      background: rgba(255,255,255,0.1);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
    }
    .team-info {
      flex: 1;
    }
    .team-name {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 2px;
    }
    .team-record {
      font-size: 12px;
      color: rgba(255,255,255,0.4);
    }
    .team-score {
      font-size: 28px;
      font-weight: 700;
      font-family: 'JetBrains Mono', monospace;
      min-width: 50px;
      text-align: right;
    }
    .team-score.winning { color: var(--green); }

    /* Stats Section */
    .game-stats {
      padding: 12px 16px;
      background: rgba(255,255,255,0.02);
      border-top: 1px solid rgba(255,255,255,0.05);
    }
    .stats-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 6px 0;
    }
    .stat-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 14px;
      font-weight: 600;
      min-width: 40px;
    }
    .stat-value.left { text-align: left; }
    .stat-value.right { text-align: right; }
    .stat-label {
      font-size: 12px;
      color: rgba(255,255,255,0.4);
      text-align: center;
      flex: 1;
    }
    .stat-bar-container {
      display: flex;
      align-items: center;
      gap: 8px;
      flex: 1;
    }
    .stat-bar {
      flex: 1;
      height: 4px;
      background: rgba(255,255,255,0.1);
      border-radius: 2px;
      overflow: hidden;
    }
    .stat-bar-fill {
      height: 100%;
      border-radius: 2px;
      transition: width 0.3s;
    }
    .stat-bar-fill.away { background: var(--green); }
    .stat-bar-fill.home { background: #06b6d4; }

    /* Loading State */
    .loading {
      text-align: center;
      padding: 60px 20px;
      color: rgba(255,255,255,0.5);
    }
    .spinner {
      width: 40px;
      height: 40px;
      border: 3px solid rgba(255,255,255,0.1);
      border-top-color: var(--green);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 16px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* Bottom Navigation */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: linear-gradient(180deg, #0a1520 0%, #050a0f 100%);
      border-top: 1px solid rgba(6, 182, 212, 0.15);
      display: flex;
      justify-content: space-around;
      align-items: flex-end;
      padding: 12px 0 28px;
      max-width: 600px;
      margin: 0 auto;
      z-index: 1000;
      width: 100%;
    }
    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      color: rgba(255,255,255,0.5);
      text-decoration: none;
      font-size: 10px;
      font-weight: 500;
      transition: all 0.2s;
    }
    .nav-item:hover { color: #fff; }
    .nav-item.active { color: #06b6d4; }
    .nav-item svg { width: 22px; height: 22px; }
    .nav-item.predictions .nav-icon { font-size: 20px; }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
    }
    .empty-icon { font-size: 48px; margin-bottom: 16px; }
    .empty-title { font-size: 18px; font-weight: 600; margin-bottom: 8px; }
    .empty-text { font-size: 14px; color: rgba(255,255,255,0.5); }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <h1 class="header-title">üìä Live Scores</h1>
    <div class="live-indicator">
      <span class="live-dot"></span>
      <span>Auto-updating</span>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main">
    <!-- League Tabs -->
    <div class="league-tabs">
      <button class="league-tab active" data-league="NBA" onclick="switchLeague('NBA')">üèÄ NBA</button>
      <button class="league-tab" data-league="NFL" onclick="switchLeague('NFL')">üèà NFL</button>
      <button class="league-tab" data-league="NHL" onclick="switchLeague('NHL')">üèí NHL</button>
    </div>

    <!-- Games Container -->
    <div class="games-container" id="gamesContainer">
      <div class="loading">
        <div class="spinner"></div>
        <div>Loading live scores...</div>
      </div>
    </div>
  </main>

  <script>
    const ODDS_API_KEY = '991bd69bd42148f1d33e00eebf65b5ee';
    const ODDS_API_BASE = 'https://api.the-odds-api.com/v4';
    const SPORT_KEYS = {
      'NBA': 'basketball_nba',
      'NFL': 'americanfootball_nfl',
      'NHL': 'icehockey_nhl'
    };

    let currentLeague = 'NBA';
    let refreshInterval = null;

    function switchLeague(league) {
      currentLeague = league;
      document.querySelectorAll('.league-tab').forEach(tab => {
        tab.classList.toggle('active', tab.dataset.league === league);
      });
      loadScores();
    }

    async function fetchScores(league) {
      const sportKey = SPORT_KEYS[league];
      if (!sportKey) return [];

      try {
        const url = `${ODDS_API_BASE}/sports/${sportKey}/scores/?apiKey=${ODDS_API_KEY}&daysFrom=1`;
        const response = await fetch(url);
        if (!response.ok) return [];
        const data = await response.json();
        return data;
      } catch (error) {
        console.error('Failed to fetch scores:', error);
        return [];
      }
    }

    function getTeamAbbrev(name) {
      return name.split(' ').pop().substring(0, 3).toUpperCase();
    }

    function getTeamEmoji(league) {
      const emojis = {
        'NBA': 'üèÄ',
        'NFL': 'üèà',
        'NHL': 'üèí'
      };
      return emojis[league] || '‚öΩ';
    }

    async function loadScores() {
      const container = document.getElementById('gamesContainer');
      container.innerHTML = `
        <div class="loading">
          <div class="spinner"></div>
          <div>Loading live scores...</div>
        </div>
      `;

      const games = await fetchScores(currentLeague);

      if (games.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">üèüÔ∏è</div>
            <div class="empty-title">No ${currentLeague} games today</div>
            <div class="empty-text">Check back later for live scores</div>
          </div>
        `;
        return;
      }

      container.innerHTML = games.map(game => {
        const awayTeam = game.away_team;
        const homeTeam = game.home_team;
        const awayScore = game.scores?.find(s => s.name === awayTeam)?.score || 0;
        const homeScore = game.scores?.find(s => s.name === homeTeam)?.score || 0;
        const isLive = !game.completed && game.scores && game.scores.length > 0;
        const isFinal = game.completed;
        const hasScores = awayScore > 0 || homeScore > 0;
        
        const gameTime = new Date(game.commence_time);
        const timeStr = gameTime.toLocaleString('en-US', { 
          weekday: 'short', 
          hour: 'numeric', 
          minute: '2-digit' 
        });

        return `
          <div class="game-card ${isLive ? 'live' : ''}">
            <div class="game-header">
              <div class="game-status ${isLive ? 'live' : isFinal ? 'final' : ''}">
                ${isLive ? '<span class="live-dot"></span> LIVE' : isFinal ? 'FINAL' : timeStr}
              </div>
              <div class="game-time">${currentLeague}</div>
            </div>
            
            <div class="team-row">
              <div class="team-logo">${getTeamEmoji(currentLeague)}</div>
              <div class="team-info">
                <div class="team-name">${awayTeam}</div>
                <div class="team-record">Away</div>
              </div>
              <div class="team-score ${parseInt(awayScore) > parseInt(homeScore) ? 'winning' : ''}">${hasScores ? awayScore : '-'}</div>
            </div>
            
            <div class="team-row">
              <div class="team-logo">${getTeamEmoji(currentLeague)}</div>
              <div class="team-info">
                <div class="team-name">${homeTeam}</div>
                <div class="team-record">Home</div>
              </div>
              <div class="team-score ${parseInt(homeScore) > parseInt(awayScore) ? 'winning' : ''}">${hasScores ? homeScore : '-'}</div>
            </div>
          </div>
        `;
      }).join('');
    }

    // Initial load
    loadScores();

    // Auto-refresh every 30 seconds
    refreshInterval = setInterval(loadScores, 30000);

    // Cleanup on page unload
    window.addEventListener('beforeunload', () => {
      if (refreshInterval) clearInterval(refreshInterval);
    });
  </script>

  <!-- Bottom Navigation -->
  <nav class="bottom-nav">
    <a href="dashboard.html" class="nav-item">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <path d="M3 10.5L12 3l9 7.5"/>
        <path d="M5 9v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V9"/>
      </svg>
      <span>Home</span>
    </a>
    <a href="predictions.html" class="nav-item predictions">
      <span class="nav-icon">üîÆ</span>
      <span>Predict</span>
    </a>
    <a href="live-scores.html" class="nav-item active">
      <svg viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
      </svg>
      <span>Live</span>
    </a>
    <a href="markets.html" class="nav-item">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <path d="M3 3v18h18"/>
        <path d="M7 16l4-4 4 4 5-6"/>
      </svg>
      <span>Markets</span>
    </a>
    <a href="portfolio.html" class="nav-item">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <circle cx="12" cy="12" r="10"/>
        <path d="M12 6v6l4 2"/>
      </svg>
      <span>Portfolio</span>
    </a>
  </nav>
</body>
</html>
